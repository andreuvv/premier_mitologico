import{j as e,c as te,n as P}from"./index-DtB_3u9q.js";import{h as oe,i as ie,r as i}from"./vendor-CDu7jYU_.js";import{A as m,a as u}from"./api-BhmblKSE.js";import{R as h,P as $,a as E,C as F,T as x,L as I,B as V,b as A,X as k,Y as D,c as z}from"./recharts-ByW0Dlvs.js";import"./react-icons-CWiluJEb.js";const j={getTournaments:async()=>{const o=await fetch(`${m}/tournaments`,{headers:{"X-API-Key":u}});if(!o.ok)throw new Error(`Failed to fetch tournaments: ${o.statusText}`);return o.json()},getTournamentStandings:async o=>{const r=await fetch(`${m}/tournaments/${o}/standings`,{headers:{"X-API-Key":u}});if(!r.ok)throw new Error(`Failed to fetch tournament standings: ${r.statusText}`);return r.json()},getTournamentRounds:async o=>{const r=await fetch(`${m}/tournaments/${o}/rounds`,{headers:{"X-API-Key":u}});if(!r.ok)throw new Error(`Failed to fetch tournament rounds: ${r.statusText}`);return r.json()},getTournamentRaces:async o=>{const r=await fetch(`${m}/tournaments/${o}/races`,{headers:{"X-API-Key":u}});if(!r.ok)throw new Error(`Failed to fetch tournament races: ${r.statusText}`);return r.json()}},ce="_container_xje7c_1",le="_pageHeader_xje7c_15",de="_overlay_xje7c_23",me="_hamburgerButton_xje7c_31",ue="_mobileTitle_xje7c_55",he="_closeSidebar_xje7c_63",xe="_sidebar_xje7c_71",je="_sidebarClosed_xje7c_101",_e="_sidebarHeader_xje7c_115",pe="_sidebarTitle_xje7c_129",ge="_loadingText_xje7c_145",be="_emptyText_xje7c_145",Ce="_tournamentList_xje7c_157",Ne="_yearGroup_xje7c_169",ve="_yearButton_xje7c_177",ye="_arrow_xje7c_217",we="_yearTournaments_xje7c_225",Te="_tournamentItem_xje7c_241",fe="_tournamentButton_xje7c_251",Re="_active_xje7c_287",Se="_viewOptions_xje7c_299",Be="_viewButton_xje7c_315",Pe="_activeView_xje7c_347",$e="_mainContent_xje7c_361",Ee="_placeholder_xje7c_373",Fe="_standingsView_xje7c_407",Ie="_roundsView_xje7c_407",Ve="_pageTitle_xje7c_417",Ae="_tableContainer_xje7c_433",ke="_standingsTable_xje7c_449",De="_topThree_xje7c_519",ze="_winsColumn_xje7c_563",Le="_tiesColumn_xje7c_573",He="_lossesColumn_xje7c_583",We="_posColumn_xje7c_593",Ge="_posCell_xje7c_603",qe="_nameColumn_xje7c_617",Ke="_totalVictoriesColumn_xje7c_629",Oe="_winRateColumn_xje7c_639",Me="_pointsColumn_xje7c_651",Xe="_goldIcon_xje7c_665",Ye="_silverIcon_xje7c_675",Je="_bronzeIcon_xje7c_685",Ue="_chartsContainer_xje7c_695",Qe="_chartSection_xje7c_711",Ze="_resumenView_xje7c_747",es="_legend_xje7c_765",ss="_tieBreakers_xje7c_765",as="_roundsContainer_xje7c_841",ns="_roundAccordion_xje7c_853",rs="_roundSummary_xje7c_867",ts="_roundTitle_xje7c_897",os="_matchesList_xje7c_905",is="_matchCard_xje7c_919",cs="_matchPlayers_xje7c_933",ls="_playerName_xje7c_947",ds="_vs_xje7c_961",ms="_matchScore_xje7c_973",us="_score_xje7c_991",hs="_winner_xje7c_999",xs="_scoreSeparator_xje7c_1007",a={container:ce,pageHeader:le,overlay:de,hamburgerButton:me,mobileTitle:ue,closeSidebar:he,sidebar:xe,sidebarClosed:je,sidebarHeader:_e,sidebarTitle:pe,loadingText:ge,emptyText:be,tournamentList:Ce,yearGroup:Ne,yearButton:ve,arrow:ye,yearTournaments:we,tournamentItem:Te,tournamentButton:fe,active:Re,viewOptions:Se,viewButton:Be,activeView:Pe,mainContent:$e,placeholder:Ee,standingsView:Fe,roundsView:Ie,pageTitle:Ve,tableContainer:Ae,standingsTable:ke,topThree:De,winsColumn:ze,tiesColumn:Le,lossesColumn:He,posColumn:We,posCell:Ge,nameColumn:qe,totalVictoriesColumn:Ke,winRateColumn:Oe,pointsColumn:Me,goldIcon:Xe,silverIcon:Ye,bronzeIcon:Je,chartsContainer:Ue,chartSection:Qe,resumenView:Ze,legend:es,tieBreakers:ss,roundsContainer:as,roundAccordion:ns,roundSummary:rs,roundTitle:ts,matchesList:os,matchCard:is,matchPlayers:cs,playerName:ls,vs:ds,matchScore:ms,score:us,winner:hs,scoreSeparator:xs},Cs=()=>{const{tournamentId:o,view:r}=oe(),L=ie(),[v,H]=i.useState([]),[_,y]=i.useState(null),[W,G]=i.useState([]),[q,K]=i.useState([]),[c,O]=i.useState(null),[M,X]=i.useState(""),[Y,J]=i.useState(!0),[p,w]=i.useState(null),[T,g]=i.useState(null),[b,C]=i.useState(!1);i.useEffect(()=>{U()},[]),i.useEffect(()=>{o&&r&&Q(Number(o),r)},[o,r]);const U=async()=>{try{const s=await j.getTournaments();if(H(s),o){const n=s.find(t=>t.id===Number(o));n&&(y(n),w(n.year),g(n.id))}}catch(s){console.error("Error loading tournaments:",s)}finally{J(!1)}},Q=async(s,n)=>{try{if(n==="standings"){const t=await j.getTournamentStandings(s);G(t)}else if(n==="rounds"){const t=await j.getTournamentRounds(s);K(t.rounds),X(t.tournament_name)}else if(n==="resumen"){const t=await j.getTournamentRaces(s);O(t)}}catch(t){console.error("Error loading tournament data:",t)}},Z=()=>{const s={};return v.forEach(n=>{s[n.year]||(s[n.year]=[]),s[n.year].push(n)}),s},ee=s=>{y(s),T===s.id?g(null):g(s.id)},N=(s,n)=>{L(`/tournament-history/${s.id}/${n}`)},se=s=>s.total_matches===0?"0.0":(s.total_points_scored/s.total_matches*100).toFixed(1),ae=s=>{const n=s.matches_played;return n===0?"0.0":((s.wins+s.ties*.5)/n*100).toFixed(1)},ne=s=>s===1?e.jsx(te,{className:a.goldIcon}):s===2?e.jsx(P,{className:a.silverIcon}):s===3?e.jsx(P,{className:a.bronzeIcon}):null,f=(s,n)=>{const t=["#6B46C1","#38A169","#D69E2E","#E53E3E","#3182CE","#805AD5","#DD6B20","#2C5282","#B83280","#38B2AC","#D4AF37","#C53030","#2D3748"],B=(n==="pb"?["Caballero","Faerie","DragÃ³n","OlÃ­mpico","TitÃ¡n","HÃ©roe","Defensor","Desafiante","Sombra","Sacerdote","FaraÃ³n","Eterno","TÃ³tem"]:["Caballero","Guerrero","Eterno","Sombra","DragÃ³n","Bestia","Sacerdote","Ancestral","HÃ©roe","BÃ¡rbaro","TÃ³tem"]).indexOf(s);return B>=0?t[B%t.length]:"#6B46C1"},d=(s,n)=>(n==="pb"?["Caballero","Faerie","DragÃ³n","OlÃ­mpico","TitÃ¡n","HÃ©roe","Defensor","Desafiante","Sombra","Sacerdote","FaraÃ³n","Eterno","TÃ³tem"]:["Caballero","Guerrero","Eterno","Sombra","DragÃ³n","Bestia","Sacerdote","Ancestral","HÃ©roe","BÃ¡rbaro","TÃ³tem"]).map(l=>({name:l,value:s[l]||0,displayName:`${l}: ${s[l]||0}`})),R=s=>Object.entries(s).map(([n,t])=>({race:n,winrate:Math.round(t*100)/100})).sort((n,t)=>t.winrate-n.winrate),S=Z(),re=Object.keys(S).map(Number).sort((s,n)=>n-s);return e.jsxs("div",{className:a.container,children:[e.jsxs("div",{className:a.pageHeader,children:[e.jsxs("button",{className:a.hamburgerButton,onClick:()=>C(!b),"aria-label":"Toggle menu",children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]}),e.jsx("h1",{className:a.mobileTitle,children:"Historial de Torneos"})]}),b&&e.jsx("div",{className:a.overlay,onClick:()=>C(!1)}),e.jsxs("aside",{className:`${a.sidebar} ${b?"":a.sidebarClosed}`,children:[e.jsxs("div",{className:a.sidebarHeader,children:[e.jsx("h2",{className:a.sidebarTitle,children:"Historial de Torneos"}),e.jsx("button",{className:a.closeSidebar,onClick:()=>C(!1),"aria-label":"Close menu",children:"âœ•"})]}),Y?e.jsx("div",{className:a.loadingText,children:"Cargando..."}):v.length===0?e.jsx("div",{className:a.emptyText,children:"No hay torneos archivados"}):e.jsx("div",{className:a.tournamentList,children:re.map(s=>e.jsxs("div",{className:a.yearGroup,children:[e.jsxs("button",{className:a.yearButton,onClick:()=>w(p===s?null:s),children:[e.jsx("span",{children:s}),e.jsx("span",{className:a.arrow,children:p===s?"â–¼":"â–¶"})]}),p===s&&e.jsx("div",{className:a.yearTournaments,children:S[s].map(n=>e.jsxs("div",{className:a.tournamentItem,children:[e.jsx("button",{className:`${a.tournamentButton} ${_?.id===n.id?a.active:""}`,onClick:()=>ee(n),children:n.month}),T===n.id&&e.jsxs("div",{className:a.viewOptions,children:[e.jsx("button",{className:`${a.viewButton} ${r==="resumen"?a.activeView:""}`,onClick:()=>N(n,"resumen"),children:"Resumen"}),e.jsx("button",{className:`${a.viewButton} ${r==="standings"?a.activeView:""}`,onClick:()=>N(n,"standings"),children:"Tabla Final"}),e.jsx("button",{className:`${a.viewButton} ${r==="rounds"?a.activeView:""}`,onClick:()=>N(n,"rounds"),children:"Rondas"})]})]},n.id))})]},s))})]}),e.jsx("main",{className:a.mainContent,children:!o||!r?e.jsxs("div",{className:a.placeholder,children:[e.jsx("h2",{children:"Selecciona un torneo y vista para ver los resultados"}),e.jsx("p",{children:"Usa el menÃº lateral para navegar por el historial de torneos"})]}):r==="resumen"?e.jsxs("div",{className:a.resumenView,children:[e.jsxs("h1",{className:a.pageTitle,children:[_?.name," - Resumen"]}),e.jsxs("div",{className:a.chartsContainer,children:[e.jsxs("div",{className:a.chartSection,children:[e.jsx("h2",{children:"Uso de Razas en Primer Bloque"}),c?e.jsx(h,{width:"100%",height:400,children:e.jsxs($,{children:[e.jsx(E,{data:d(c.pb_races,"pb"),cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"value",label:s=>s.value>0?`${s.value}`:"",labelLine:!1,children:d(c.pb_races,"pb").map((s,n)=>e.jsx(F,{fill:f(s.name,"pb")},`cell-${n}`))}),e.jsx(x,{}),e.jsx(I,{formatter:(s,n)=>n.payload.displayName,wrapperStyle:{color:"var(--beige)"}})]})}):e.jsx("p",{children:"No hay datos de razas para Primer Bloque"})]}),e.jsxs("div",{className:a.chartSection,children:[e.jsx("h2",{children:"Uso de Razas en Bloque Furia"}),c?e.jsx(h,{width:"100%",height:400,children:e.jsxs($,{children:[e.jsx(E,{data:d(c.bf_races,"bf"),cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"value",label:s=>s.value>0?`${s.value}`:"",labelLine:!1,children:d(c.bf_races,"bf").map((s,n)=>e.jsx(F,{fill:f(s.name,"bf")},`cell-${n}`))}),e.jsx(x,{}),e.jsx(I,{formatter:(s,n)=>n.payload.displayName,wrapperStyle:{color:"var(--beige)"}})]})}):e.jsx("p",{children:"No hay datos de razas para Bloque Furia"})]}),e.jsxs("div",{className:a.chartSection,children:[e.jsx("h2",{children:"Winrate por Raza - Primer Bloque"}),c?e.jsx(h,{width:"100%",height:400,children:e.jsxs(V,{data:R(c.pb_race_winrates),children:[e.jsx(A,{strokeDasharray:"3 3"}),e.jsx(k,{dataKey:"race",angle:-45,textAnchor:"end",height:80,interval:0}),e.jsx(D,{label:{value:"Winrate (%)",angle:-90,position:"insideLeft"}}),e.jsx(x,{formatter:s=>[`${s}%`,"Winrate"],contentStyle:{color:"var(--coal-grey)"}}),e.jsx(z,{dataKey:"winrate",fill:"#38A169",label:{fill:"white",fontSize:12,position:"inside"}})]})}):e.jsx("p",{children:"No hay datos de winrates para Primer Bloque"})]}),e.jsxs("div",{className:a.chartSection,children:[e.jsx("h2",{children:"Winrate por Raza - Bloque Furia"}),c?e.jsx(h,{width:"100%",height:400,children:e.jsxs(V,{data:R(c.bf_race_winrates),children:[e.jsx(A,{strokeDasharray:"3 3"}),e.jsx(k,{dataKey:"race",angle:-45,textAnchor:"end",height:80,interval:0}),e.jsx(D,{label:{value:"Winrate (%)",angle:-90,position:"insideLeft"}}),e.jsx(x,{formatter:s=>[`${s}%`,"Winrate"],contentStyle:{color:"var(--coal-grey)"}}),e.jsx(z,{dataKey:"winrate",fill:"#E53E3E",label:{fill:"white",fontSize:12,position:"inside"}})]})}):e.jsx("p",{children:"No hay datos de winrates para Bloque Furia"})]})]})]}):r==="standings"?e.jsxs("div",{className:a.standingsView,children:[e.jsxs("h1",{className:a.pageTitle,children:[_?.name," - Tabla Final"]}),e.jsx("div",{className:a.tableContainer,children:e.jsxs("table",{className:a.standingsTable,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:a.posColumn,children:"Pos."}),e.jsx("th",{className:a.nameColumn,children:"Jugador"}),e.jsx("th",{children:"Raza PB"}),e.jsx("th",{children:"Raza BF"}),e.jsx("th",{children:"RJ"}),e.jsx("th",{children:"G"}),e.jsx("th",{children:"E"}),e.jsx("th",{children:"P"}),e.jsx("th",{children:"TPG"}),e.jsx("th",{children:"MWR%"}),e.jsx("th",{children:"RWR%"}),e.jsx("th",{children:"Pts"})]})}),e.jsx("tbody",{children:W.map(s=>{const n=s.final_position;return e.jsxs("tr",{className:n<=3?a.topThree:"",children:[e.jsx("td",{className:a.posColumn,children:e.jsxs("div",{className:a.posCell,children:[ne(n),e.jsx("span",{children:n})]})}),e.jsx("td",{className:a.nameColumn,children:s.player_name}),e.jsx("td",{children:s.race_pb||"-"}),e.jsx("td",{children:s.race_bf||"-"}),e.jsx("td",{children:s.matches_played}),e.jsx("td",{className:a.winsColumn,children:s.wins}),e.jsx("td",{className:a.tiesColumn,children:s.ties}),e.jsx("td",{className:a.lossesColumn,children:s.losses}),e.jsx("td",{className:a.totalVictoriesColumn,children:s.total_points_scored}),e.jsxs("td",{className:a.winRateColumn,children:[se(s),"%"]}),e.jsxs("td",{className:a.winRateColumn,children:[ae(s),"%"]}),e.jsx("td",{className:a.pointsColumn,children:s.points})]},s.id)})})]})}),e.jsxs("div",{className:a.legend,children:[e.jsx("h3",{children:"Leyenda"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Pos:"})," PosiciÃ³n Final"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Raza PB:"})," Raza elegida en Primer Bloque"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Raza BF:"})," Raza elegida en Bloque Furia"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"RJ:"})," Rondas Jugadas"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"G:"})," Rondas Ganadas"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"E:"})," Rondas Empatadas"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"P:"})," Rondas Perdidas"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"TPG:"})," Total Partidas Ganadas (partidas individuales ganadas)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"MWR%:"})," Matches Win Rate ( (Partidas ganadas / Partidas jugadas) * 100 )"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"RWR%:"})," Rounds Win Rate ( ((Rondas ganadas + Rondas empatadas * 0.5) / Rondas Jugadas) * 100 )"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Pts:"})," Puntos (3 por victoria, 1 por empate)"]})]})]}),e.jsxs("div",{className:a.tieBreakers,children:[e.jsx("h3",{children:"Criterios de Desempate"}),e.jsxs("ol",{children:[e.jsxs("li",{children:["â­ ",e.jsx("strong",{children:"Puntaje total"})," (mayor puntaje)"]}),e.jsxs("li",{children:["ðŸ’ª ",e.jsx("strong",{children:"Mayor cantidad de victorias"})]}),e.jsxs("li",{children:["ðŸŽ¯ ",e.jsx("strong",{children:"Victoria directa"})," (ganÃ³ al otro jugador empatado durante las rondas)"]}),e.jsxs("li",{children:["âš”ï¸ ",e.jsx("strong",{children:"Duelo de desempate"})," (si ningÃºn criterio anterior resuelve)"]})]})]})]}):e.jsxs("div",{className:a.roundsView,children:[e.jsxs("h1",{className:a.pageTitle,children:[M," - Rondas"]}),e.jsx("div",{className:a.roundsContainer,children:q.map(s=>e.jsxs("details",{className:a.roundAccordion,children:[e.jsx("summary",{className:a.roundSummary,children:e.jsxs("span",{className:a.roundTitle,children:["Ronda ",s.number," - ",s.format==="PB"?"Primer Bloque":"Bloque Furia"]})}),e.jsx("div",{className:a.matchesList,children:s.matches.map(n=>e.jsxs("div",{className:a.matchCard,children:[e.jsxs("div",{className:a.matchPlayers,children:[e.jsx("span",{className:a.playerName,children:n.player1_name}),e.jsx("span",{className:a.vs,children:"VS"}),e.jsx("span",{className:a.playerName,children:n.player2_name})]}),n.completed&&n.score1!==null&&n.score2!==null&&e.jsxs("div",{className:a.matchScore,children:[e.jsx("span",{className:`${a.score} ${n.score1>n.score2?a.winner:""}`,children:n.score1}),e.jsx("span",{className:a.scoreSeparator,children:"-"}),e.jsx("span",{className:`${a.score} ${n.score2>n.score1?a.winner:""}`,children:n.score2})]})]},n.id))})]},s.number))})]})})]})};export{Cs as default};
